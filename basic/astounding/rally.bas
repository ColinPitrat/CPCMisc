10 REM******RALLY 3000******
20 INK 1,24
30 INK 3, 13
40 INK 2,2
50 MODE 1
60 RANDOMIZE TIME
70 INK 0,9
80 BORDER 0
90 CLS
100 WINDOW #1,1,40,1,6
110 PAPER #1,2
120 CLS #1
130 D=0: Z=0: ZZ=0
140 PEN 1
150 FOR T=1 TO 360 STEP 3
160 PLOT 600,380
170 DRAW 600+20*COS (T), 380+20*SIN(T) ,1
180 NEXT T
190 P=310
200 PEN 3
210 LOCATE 18,25
220 PRINT CHR$ (151) CHR$ (155); CHR$ (1 57)
230 REM*****MAIN LOOP*****
240 IF RND>0.8 THEN Z=40: ZZ=-40: GOTO 260 ELSE Z=0: ZZ=0
250 IF RND<0.04 THEN Z=60: ZZ=-60 ELSE Z=0: ZZ=0
260 PLOT 0,300
270 DRAW 640,300,3
280 PLOT P, 300, 1
290 DRAW P-120+Z,0,1
300 PLOT P+20,300, 1
310 DRAW P+140+ZZ,0,1
320 PLOT P,300,0
330 DRAW P-120+Z, 0,0
340 PLOT P+20,300,0
350 DRAW P+140+ZZ,0,0
360 IF P+Z>382 OR P-Z<200 THEN GOTO 450
370 SOUND 4,500,2
380 M$=INKEY$
390 IF M$=" " THEN GOSUB 660
400 IF M$="9" THEN P=P-20
410 IF M$="7" THEN P=P+20
420 D=D+4
430 P=P+INT(RND*60)-30
440 GOTO 230
450 REM*****CRASH ROUTINE*****
450 INK 3,7,15
470 FOR T=500 TO 1000
480 SOUND 1,T,1
490 SOUND 2,T,1
500 SOUND 3, T,1
510 SOUND 4, T, 1
520 NEXT T
530 LOCATE 4,9
540 PRINT "You managed to cover ";D; "miles"
545 PRINT "   of the most gruelling rally"
550 PRINT "   circuit in the world."
560 PRINT "   Your rating therefore is"
570 PRINT: PRINT "   ";
580 IF D<250 THEN PRINT "AWFUL, A DEFINITE 'L' DRIVER"
590 IF D>249 AND D<700 THEN PRINT "FAIR, BUT MUCH NEED FOR IMPROVEMENT"
600 IF D>699 AND D<1500 THEN PRINT "NOT BAD. BUT NOT IN THE TOP CLASS"
610 IF D>1499 AND D<2400 THEN PRINT "GOOD EFFORT, MORE STAMINA NEEDED"
620 IF D>2399 THEN PRINT "SUPERB! EXCELLENT! BUT NOT THE WINNER OFTHE RALLY 3000"
630 IF D>2999 THEN PRINT "THE WINNER !!!! WHAT STYLE, WHAT CLASS, WHAT STAYING POWER!"
640 SOUND 1,3050-D, 150
650 LOCATE 4,17:PRINT "PLAY AGAIN? (Y/N)":
652 R$=INKEY$
653 IF R$="Y" OR R$="y" THEN GOTO 10
654 IF R$="N" OR R$="n" THEN GOTO 690
655 GOTO 652
660 REM***PAUSE****
670 WHILE INKEY$<>"":WEND
680 RETURN
690 PRINT "BYE THEN!"
